<!DOCTYPE html> 
<html> <head> <meta charset="utf-8"> <title>Happy Birthday </title> </head> 
<body>

<audio id="hb_music" src="dida.mp3" hidden="true" controls="controls" autoplay="autoplay" preload id="hb_music" loop ="true"></audio> 
<div id="hb_text" style="font-size:60px" > </div> 

<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script>
    function autoPlayAudio1() {
        wx.config({
            debug: false,
            appId: '',
            timestamp: 1,
            nonceStr: '',
            signature: '',
            jsApiList: []
        });
        wx.ready(function() {
            document.getElementById('hb_music').play();
        });
    }
	autoPlayAudio1();
</script>

<script>
(function() {
  if (typeof WeixinJSBridge == "object" && typeof WeixinJSBridge.invoke == "function") {
    handleFontSize();
  } else {
    if (document.addEventListener) {
      document.addEventListener("WeixinJSBridgeReady", handleFontSize, false);
    } else if (document.attachEvent) {
      //IE浏览器，非W3C规范
      document.attachEvent("onWeixinJSBridgeReady", handleFontSize);
    }
  }
  function handleFontSize() {
    // 设置网页字体为默认大小
    WeixinJSBridge.invoke('setFontSizeCallback', { 'fontSize' : 0 });
    // 重写设置网页字体大小的事件
    WeixinJSBridge.on('menu:setfont', function() {
      WeixinJSBridge.invoke('setFontSizeCallback', { 'fontSize' : 0 });
    });
  }
})();
</script>

<script>
  let audio = document.getElementById('hb_music');
  let divTyping = document.getElementById('hb_text');
  let i = 0,
  timer = 0,
  //str = '(苹果系统有bug)<br/>致乐哥:<br/><p>（阳江话读）捻都一下，自从大家分道扬镳读都高中之后，我好似无等乐哥生日那日，主动献上祝福个，一般都似采朋友圈点个赞。唉，捻捻子，十几年交情估子讲无过去，我也系尴尬，我咪谁个生日都记无紧那种，今年提前设都一个日历闹钟,今朝乐嫂也成都双重闹钟。好，开始祝福：祝生日快乐，身体健康，家庭快乐!</p>'
  str = 'Dear Miss Chen:<br/>Happy Valentine\'s Day';
  function typing () {
    if (i <= str.length) {
      divTyping.innerHTML = str.slice(0, i++) + '_'
      timer = setTimeout('typing()', 300)
    }
    else {
      divTyping.innerHTML = str
      clearTimeout(timer)
	  if(audio != null){
		if(!audio.paused){
			audio.pause();
		}
	  }
    }
  }

  typing()
</script> 
</body> 
</html>
